# å¾®ä¿¡å°ç¨‹åº AppID å’Œ AppSecret å®‰å…¨é…ç½®æŒ‡å—

## ğŸ“‹ é—®é¢˜è¯´æ˜

å¾®ä¿¡å°ç¨‹åºçš„ AppID å’Œ AppSecret æ˜¯æ•æ„Ÿä¿¡æ¯ï¼Œä¸åº”è¯¥ç›´æ¥æäº¤åˆ° Git ä»“åº“ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´ï¼š
- âœ… AppSecret æ³„éœ²ï¼Œè¢«ä»–äººæ¶æ„ä½¿ç”¨
- âœ… è´¦å·å®‰å…¨é£é™©
- âœ… æ•°æ®æ³„éœ²é£é™©

## âœ… å·²å®Œæˆçš„å®‰å…¨é…ç½®

### 1. é…ç½®æ–‡ä»¶åˆ†ç¦»

**ä¸»é…ç½®æ–‡ä»¶** (`application.yml`):
- âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡å ä½ç¬¦
- âœ… å¯ä»¥å®‰å…¨æäº¤åˆ° Git ä»“åº“
- âœ… ä¸åŒ…å«æ•æ„Ÿä¿¡æ¯

```yaml
wechat:
  appid: ${WECHAT_APPID}
  secret: ${WECHAT_SECRET}
```

**æœ¬åœ°é…ç½®æ–‡ä»¶** (`application-local.yml`):
- âœ… åŒ…å«çœŸå®çš„ AppID å’Œ AppSecret
- âœ… å·²æ·»åŠ åˆ° .gitignoreï¼Œä¸ä¼šæäº¤åˆ° Git
- âœ… ä»…åœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒä½¿ç”¨

```yaml
wechat:
  appid: wxa1f6632efb5a19e5
  secret: 78433b13eeeb5c04add01850248be9ba
```

**é…ç½®æ¨¡æ¿** (`application-local.yml.template`):
- âœ… æä¾›é…ç½®ç¤ºä¾‹
- âœ… å¯ä»¥å®‰å…¨æäº¤åˆ° Git
- âœ… å›¢é˜Ÿæˆå‘˜å¯ä»¥å¤åˆ¶å¹¶å¡«å…¥è‡ªå·±çš„é…ç½®

### 2. .gitignore é…ç½®

å·²æ·»åŠ ä»¥ä¸‹è§„åˆ™åˆ° `.gitignore`:

```gitignore
# æ•æ„Ÿé…ç½®æ–‡ä»¶
application-local.yml
application-dev.yml
application-prod.yml

# ç¯å¢ƒå˜é‡æ–‡ä»¶
.env
.env.local
.env.*.local

# å°ç¨‹åº
project.private.config.json
```

### 3. Spring Boot é…ç½®

åœ¨ `application.yml` ä¸­æ¿€æ´»æœ¬åœ°é…ç½®:

```yaml
spring:
  profiles:
    active: local
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•1: ä½¿ç”¨æœ¬åœ°é…ç½®æ–‡ä»¶ï¼ˆæ¨èï¼‰

1. **å¤åˆ¶é…ç½®æ¨¡æ¿**:
   ```bash
   cd src/main/resources
   cp application-local.yml.template application-local.yml
   ```

2. **å¡«å…¥çœŸå®é…ç½®**:
   ç¼–è¾‘ `application-local.yml`ï¼Œå¡«å…¥ä½ çš„ AppID å’Œ AppSecret:
   ```yaml
   wechat:
     appid: wxa1f6632efb5a19e5
     secret: 78433b13eeeb5c04add01850248be9ba
   ```

3. **å¯åŠ¨åº”ç”¨**:
   ```bash
   mvn spring-boot:run
   ```

### æ–¹æ³•2: ä½¿ç”¨ç¯å¢ƒå˜é‡

#### Windows (CMD)
```cmd
set WECHAT_APPID=wxa1f6632efb5a19e5
set WECHAT_SECRET=78433b13eeeb5c04add01850248be9ba
mvn spring-boot:run
```

#### Windows (PowerShell)
```powershell
$env:WECHAT_APPID="wxa1f6632efb5a19e5"
$env:WECHAT_SECRET="78433b13eeeb5c04add01850248be9ba"
mvn spring-boot:run
```

#### Linux/Mac
```bash
export WECHAT_APPID=wxa1f6632efb5a19e5
export WECHAT_SECRET=78433b13eeeb5c04add01850248be9ba
mvn spring-boot:run
```

### æ–¹æ³•3: ä½¿ç”¨ IDE é…ç½®

#### IntelliJ IDEA

1. æ‰“å¼€ Run/Debug Configurations
2. é€‰æ‹©ä½ çš„ Spring Boot åº”ç”¨
3. åœ¨ Environment variables ä¸­æ·»åŠ :
   ```
   WECHAT_APPID=wxa1f6632efb5a19e5;WECHAT_SECRET=78433b13eeeb5c04add01850248be9ba
   ```

#### Eclipse

1. å³é”®é¡¹ç›® â†’ Run As â†’ Run Configurations
2. é€‰æ‹© Environment æ ‡ç­¾
3. æ·»åŠ ç¯å¢ƒå˜é‡:
   - Name: `WECHAT_APPID`, Value: `wxa1f6632efb5a19e5`
   - Name: `WECHAT_SECRET`, Value: `78433b13eeeb5c04add01850248be9ba`

## ğŸ“ æ–‡ä»¶ç»“æ„

```
ZhiTongXiaoYuan/
â”œâ”€â”€ .gitignore                                    # Git å¿½ç•¥è§„åˆ™
â”œâ”€â”€ src/
â”‚   â””â”€â”€ main/
â”‚       â””â”€â”€ resources/
â”‚           â”œâ”€â”€ application.yml                   # ä¸»é…ç½®ï¼ˆå¯æäº¤ï¼‰
â”‚           â”œâ”€â”€ application-local.yml             # æœ¬åœ°é…ç½®ï¼ˆä¸æäº¤ï¼‰
â”‚           â””â”€â”€ application-local.yml.template    # é…ç½®æ¨¡æ¿ï¼ˆå¯æäº¤ï¼‰
â””â”€â”€ README.md
```

## ğŸ”’ å®‰å…¨æœ€ä½³å®è·µ

### 1. æ°¸è¿œä¸è¦æäº¤æ•æ„Ÿä¿¡æ¯

âŒ **é”™è¯¯åšæ³•**:
```yaml
# application.yml
wechat:
  appid: wxa1f6632efb5a19e5
  secret: 78433b13eeeb5c04add01850248be9ba
```

âœ… **æ­£ç¡®åšæ³•**:
```yaml
# application.yml
wechat:
  appid: ${WECHAT_APPID}
  secret: ${WECHAT_SECRET}
```

### 2. ä½¿ç”¨ä¸åŒçš„é…ç½®æ–‡ä»¶

- `application.yml` - å…¬å…±é…ç½®ï¼ˆå¯æäº¤ï¼‰
- `application-local.yml` - æœ¬åœ°å¼€å‘é…ç½®ï¼ˆä¸æäº¤ï¼‰
- `application-dev.yml` - å¼€å‘ç¯å¢ƒé…ç½®ï¼ˆä¸æäº¤ï¼‰
- `application-prod.yml` - ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼ˆä¸æäº¤ï¼‰

### 3. å®šæœŸæ›´æ¢å¯†é’¥

å¦‚æœ AppSecret å·²ç»æ³„éœ²ï¼š
1. ç«‹å³åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°é‡ç½® AppSecret
2. æ›´æ–°æ‰€æœ‰ç¯å¢ƒçš„é…ç½®
3. æ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸è®¿é—®

### 4. ä½¿ç”¨å¯†é’¥ç®¡ç†æœåŠ¡

ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ä¸“ä¸šçš„å¯†é’¥ç®¡ç†æœåŠ¡ï¼š
- AWS Secrets Manager
- Azure Key Vault
- HashiCorp Vault
- é˜¿é‡Œäº‘å¯†é’¥ç®¡ç†æœåŠ¡

## ğŸ§ª éªŒè¯é…ç½®

### 1. æ£€æŸ¥é…ç½®æ˜¯å¦ç”Ÿæ•ˆ

å¯åŠ¨åº”ç”¨åï¼ŒæŸ¥çœ‹æ—¥å¿—ï¼š

```
Wechat AppID: wxa1f6632efb5a19e5
Wechat Secret: 784***ba (å·²è„±æ•)
```

### 2. æµ‹è¯•ç™»å½•æ¥å£

```bash
curl -X POST http://localhost:8080/api/user/login \
  -H "Content-Type: application/json" \
  -d '{"code":"test-code","nickname":"æµ‹è¯•ç”¨æˆ·","avatar":""}'
```

### 3. æ£€æŸ¥ Git çŠ¶æ€

```bash
git status
```

ç¡®è®¤ `application-local.yml` ä¸åœ¨å¾…æäº¤åˆ—è¡¨ä¸­ã€‚

## ğŸ”§ å›¢é˜Ÿåä½œ

### æ–°æˆå‘˜åŠ å…¥é¡¹ç›®

1. **å…‹éš†é¡¹ç›®**:
   ```bash
   git clone <repository-url>
   cd ZhiTongXiaoYuan
   ```

2. **åˆ›å»ºæœ¬åœ°é…ç½®**:
   ```bash
   cd src/main/resources
   cp application-local.yml.template application-local.yml
   ```

3. **å¡«å…¥é…ç½®**:
   å‘å›¢é˜Ÿè´Ÿè´£äººç´¢å– AppID å’Œ AppSecretï¼Œå¡«å…¥ `application-local.yml`

4. **å¯åŠ¨é¡¹ç›®**:
   ```bash
   mvn spring-boot:run
   ```

### é…ç½®æ–‡æ¡£

åœ¨é¡¹ç›® README ä¸­æ·»åŠ é…ç½®è¯´æ˜ï¼š

```markdown
## é…ç½®è¯´æ˜

1. å¤åˆ¶é…ç½®æ¨¡æ¿:
   ```bash
   cp src/main/resources/application-local.yml.template \
      src/main/resources/application-local.yml
   ```

2. å¡«å…¥å¾®ä¿¡å°ç¨‹åºé…ç½®ï¼ˆå‘é¡¹ç›®è´Ÿè´£äººç´¢å–ï¼‰

3. å¯åŠ¨é¡¹ç›®
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. å·²æäº¤çš„æ•æ„Ÿä¿¡æ¯

å¦‚æœä¹‹å‰å·²ç»æäº¤äº†åŒ…å«æ•æ„Ÿä¿¡æ¯çš„æ–‡ä»¶ï¼š

```bash
# ä» Git å†å²ä¸­åˆ é™¤æ•æ„Ÿæ–‡ä»¶
git filter-branch --force --index-filter \
  "git rm --cached --ignore-unmatch src/main/resources/application.yml" \
  --prune-empty --tag-name-filter cat -- --all

# å¼ºåˆ¶æ¨é€
git push origin --force --all
```

**è­¦å‘Š**: è¿™ä¼šé‡å†™ Git å†å²ï¼Œéœ€è¦å›¢é˜Ÿæ‰€æœ‰æˆå‘˜é‡æ–°å…‹éš†ä»“åº“ã€‚

### 2. å°ç¨‹åº project.config.json

å°ç¨‹åºçš„ `project.config.json` ä¹ŸåŒ…å« AppIDï¼Œå·²æ·»åŠ åˆ° `.gitignore`ã€‚

å¦‚æœéœ€è¦æäº¤ï¼Œå¯ä»¥åˆ›å»ºæ¨¡æ¿æ–‡ä»¶ï¼š

```json
// project.config.json.template
{
  "appid": "your-appid-here",
  // ... å…¶ä»–é…ç½®
}
```

### 3. ç¯å¢ƒå˜é‡ä¼˜å…ˆçº§

Spring Boot é…ç½®ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼š
1. å‘½ä»¤è¡Œå‚æ•°
2. ç³»ç»Ÿç¯å¢ƒå˜é‡
3. `application-{profile}.yml`
4. `application.yml`

## ğŸ“ æ£€æŸ¥æ¸…å•

æäº¤ä»£ç å‰ï¼Œè¯·ç¡®è®¤ï¼š

- [ ] `application.yml` ä¸­æ²¡æœ‰ç¡¬ç¼–ç çš„ AppID å’Œ AppSecret
- [ ] `application-local.yml` å·²æ·»åŠ åˆ° `.gitignore`
- [ ] `application-local.yml.template` ä¸åŒ…å«çœŸå®é…ç½®
- [ ] `project.private.config.json` å·²æ·»åŠ åˆ° `.gitignore`
- [ ] è¿è¡Œ `git status` ç¡®è®¤æ²¡æœ‰æ•æ„Ÿæ–‡ä»¶å¾…æäº¤
- [ ] å›¢é˜Ÿæˆå‘˜çŸ¥é“å¦‚ä½•é…ç½®æœ¬åœ°ç¯å¢ƒ

## ğŸ‰ æ€»ç»“

### å·²å®Œæˆçš„å®‰å…¨æªæ–½

âœ… é…ç½®æ–‡ä»¶åˆ†ç¦»ï¼ˆä¸»é…ç½® + æœ¬åœ°é…ç½®ï¼‰
âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡å ä½ç¬¦
âœ… æ·»åŠ  .gitignore è§„åˆ™
âœ… åˆ›å»ºé…ç½®æ¨¡æ¿æ–‡ä»¶
âœ… æä¾›å¤šç§é…ç½®æ–¹æ³•

### å®‰å…¨æ€§æå‡

âœ… AppSecret ä¸ä¼šæ³„éœ²åˆ° Git ä»“åº“
âœ… å›¢é˜Ÿæˆå‘˜å¯ä»¥ä½¿ç”¨å„è‡ªçš„é…ç½®
âœ… ç”Ÿäº§ç¯å¢ƒå¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡
âœ… ç¬¦åˆå®‰å…¨æœ€ä½³å®è·µ

ç°åœ¨ä½ çš„å¾®ä¿¡å°ç¨‹åºå¯†é’¥å·²ç»å®‰å…¨éšè—ï¼Œå¯ä»¥æ”¾å¿ƒæäº¤åˆ° Git ä»“åº“äº†ï¼ğŸ‰
